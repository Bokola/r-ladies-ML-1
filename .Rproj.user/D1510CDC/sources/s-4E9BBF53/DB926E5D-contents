---
title: "ML-Workshop-RMD"
author: "Sarah Romanes"
date: "30 September 2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
Income <- structure(list(Education = c(10, 10.4013377926421, 
10.8428093645485, 11.2441471571906, 11.6454849498328, 12.0869565217391, 
12.4882943143813, 12.8896321070234, 13.2909698996656, 13.7324414715719, 
14.133779264214, 14.5351170568562, 14.9765886287625, 15.3779264214047, 
15.7792642140468, 16.2207357859532, 16.6220735785953, 17.0234113712375, 
17.4648829431438, 17.866220735786, 18.2675585284281, 18.7090301003344, 
19.1103678929766, 19.5117056856187, 19.9130434782609, 20.3545150501672, 
20.7558528428094, 21.1571906354515, 21.5986622073579, 22), Income = c(26.6588387834389, 
27.3064353457772, 22.1324101716143, 21.1698405046065, 15.1926335164307, 
26.3989510407284, 17.435306578572, 25.5078852305278, 36.884594694235, 
39.666108747637, 34.3962805641312, 41.4979935356871, 44.9815748660704, 
47.039595257834, 48.2525782901863, 57.0342513373801, 51.4909192102538, 
61.3366205527288, 57.581988179306, 68.5537140185881, 64.310925303692, 
68.9590086393083, 74.6146392793647, 71.8671953042483, 76.098135379724, 
75.77521802986, 72.4860553152424, 77.3550205741877, 72.1187904524136, 
80.2605705009016)), .Names = c("Education", "Income"), class = "data.frame", row.names = c(NA, 
-30L))


write.csv(Income, file="data/Income.csv", row.names = FALSE)
```

```{r}
library("ggplot2")

Income <- structure(list(X = 1:30, Education = c(10, 10.4013377926421, 
10.8428093645485, 11.2441471571906, 11.6454849498328, 12.0869565217391, 
12.4882943143813, 12.8896321070234, 13.2909698996656, 13.7324414715719, 
14.133779264214, 14.5351170568562, 14.9765886287625, 15.3779264214047, 
15.7792642140468, 16.2207357859532, 16.6220735785953, 17.0234113712375, 
17.4648829431438, 17.866220735786, 18.2675585284281, 18.7090301003344, 
19.1103678929766, 19.5117056856187, 19.9130434782609, 20.3545150501672, 
20.7558528428094, 21.1571906354515, 21.5986622073579, 22), Income = c(26.6588387834389, 
27.3064353457772, 22.1324101716143, 21.1698405046065, 15.1926335164307, 
26.3989510407284, 17.435306578572, 25.5078852305278, 36.884594694235, 
39.666108747637, 34.3962805641312, 41.4979935356871, 44.9815748660704, 
47.039595257834, 48.2525782901863, 57.0342513373801, 51.4909192102538, 
61.3366205527288, 57.581988179306, 68.5537140185881, 64.310925303692, 
68.9590086393083, 74.6146392793647, 71.8671953042483, 76.098135379724, 
75.77521802986, 72.4860553152424, 77.3550205741877, 72.1187904524136, 
80.2605705009016)), .Names = c("X", "Education", "Income"), class = "data.frame", row.names = c(NA, 
-30L))

coef=c(-39.4463,5.5995)

Fitted <- coef[1] + coef[2]*Income$Education

Income <- transform(Income, Fitted = Fitted)


ggplot(Income, aes(Education, Income)) + 
  geom_point(color="red") + 
  geom_abline(slope=coef[2], intercept=coef[1]) +
  geom_segment(aes(x = Education, y = Income,
                   xend = Education, yend = Fitted))

sum((Income$Fitted-Income$Income)^2)

summary(lm(data=Income, Income~Education))

```


```{r}
size <- c(0.245, 0.247, 0.285, 0.299, 0.327, 0.347, 0.356, 0.36, 0.363, 0.364, 0.398, 0.4, 0.409, 0.421, 0.432, 0.473, 0.509, 0.529, 0.561, 0.569, 0.594, 0.638, 0.656, 0.816, 0.853, 0.938, 1.036, 1.045)
spiders <- c("absent", "absent", "absent", "absent", "absent", "absent", "absent", "absent", "absent","absent", "absent", "absent", "absent", "absent", "absent", "absent", "absent", "absent", "absent", "absent", "present", "present", "present", "present", "present", "present", "present", "present" )

spiders <- ifelse(spiders=="present",1,0)

plot(size, as.numeric(spiders))


data=data.frame(GrainSize=size, Spiders=spiders)
write.csv(data, file="data/SpidersWarning.csv", row.names = FALSE)

fit <-  glm(data=data,
            Spiders~GrainSize,
            family=binomial(link="logit"))

summary(fit)
```



